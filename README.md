# Supermarket SQL Database

**Реляционная БД для продуктового супермаркета на MS SQL Server (T-SQL) с полным циклом бизнес-логики.**

---

## О проекте

Проектирование и реализация базы данных для автоматизации работы супермаркета:

- Учёт товаров, остатков и поставок
- Система продаж со скидками клиентов
- Управление сотрудниками и графиками
- Аналитические отчёты по отделам и кассам

## Структура БД

11 нормализованных таблиц (3NF):

1. Sections (Разделы) – Представляют собой отделы супермаркета (например, овощи,
   мясо, молочные продукты).
2. Desks (Кассы) – Места, где происходят продажи товаров. Каждая касса связана с
   определенным отделом супермаркета.
3. Employees (Сотрудники) – Работники супермаркета.
4. WorkSchedule (График работы) – График работы сотрудников на различных
   кассах по дням.
5. Suppliers (Поставщики) – Компании, которые поставляют товары в супермаркет.
6. Supplies (Поставки) – Информация о поставках товаров от поставщиков, включая
   дату и сумму поставки.
7. SupplyDetails (Детали поставки) – Детализированная информация о каждом
   товаре в составе поставки, включая количество и цену.
8. Products (Товары) – Информация о товарах, включая название, категорию, срок
   хранения и связь с разделами супермаркета.
9. Customer (Клиенты) – Информация о клиентах, включая имя, фамилию и скидку.
10. Sales (Продажи) – Информация о продажах, включая дату, торговую точку и
    клиента.
11. SalesDetails (Детали продажи) – Детализированная информация о каждом товаре,
    проданном в рамках конкретной продажи.

## Реализованный функционал (T-SQL)

В проекте используются продвинутые инструменты MS SQL Server:

### Представления (Views)

- `vDesksSalesSummary` - аналитика продаж по каждой кассе с учетом скидок для клиентов
- `vSectionsSalesSummary` - аналитика продаж по отделам с учетом скидок для клиентов
- `vSalesWithDiscounts` - предоставляет удобный набор данных, описывающих покупателей и совершенные ими покупки
- `vEmployee` - обновляемое представление, предназначено для получения списка сотрудников магазина

### Функции (UDF)

- `GetSalesByDateRange` - отчётность по продажам за период
- `GetProductStock` - расчёт актуальных остатков на складе
- `GetTotalAmountSpentByCustomer` - подсчёт суммы покупок клиента

### Хранимые процедуры

- `AddNewSupply` / `AddNewSale` - комплексное добавление данных с расчётом сумм
- `CustomerDiscountUpdate` - автоматическая корректировка скидки клиента
- `pr_InsertIntovEmployee` / `pr_DeleteFromEmployee` - управление сотрудниками

### Триггеры

- `trg_CheckStockOnInsert` - предотвращает продажу при отсутствии товара
- `trg_DeleteEmployee` - каскадное удаление расписания при удалении сотрудника
- `trg_DeletingSuppliesAndDetails` - обеспечение целостности данных поставок

## Технологии

- **СУБД:** Microsoft SQL Server
- **Язык:** T-SQL
- **Проектирование:** ERD, нормализация (3NF)

## Контакты

**Автор:** Полина Николаева  
**GitHub:** [@paulinnik](https://github.com/paulinnik)  
**Email:** pollynik2005@mail.ru
